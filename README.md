# MyGoMessenger

Простое приложение для обмена сообщениями, созданное с использованием Go и микросервисов.

## Технологии

- **Go**: Основной язык программирования.
- **gRPC**: Для синхронного взаимодействия между сервисами.
- **Protocol Buffers**: Для определения контрактов API.
- **Kafka**: Для асинхронной обработки сообщений (уведомлений).
- **PostgreSQL**: В качестве основной базы данных.
- **Docker & Docker Compose**: Для контейнеризации и оркестрации приложения.

## Архитектура

Приложение состоит из трех микросервисов:

- **Сервис пользователей**: Управляет регистрацией пользователей.
- **Сервис сообщений**: Обрабатывает отправку и получение сообщений.
- **Сервис уведомлений**: Прослушивает новые сообщения в Kafka и логирует их (в качестве примера).

Сервисы взаимодействуют друг с другом с помощью gRPC для синхронных вызовов и Kafka для асинхронных. Данные хранятся в базе данных PostgreSQL.

## Предварительные требования

- Docker
- Docker Compose
- Go (для запуска клиента и генерации кода)
- `protoc` (компилятор Protocol Buffers)

## Начало работы

1.  Клонируйте репозиторий.
2.  Создайте файл `.env` в корне проекта со следующим содержимым:

    ```
    POSTGRES_USER=user
    POSTGRES_PASSWORD=password
    POSTGRES_DB=mydatabase
    ```

3.  Выполните следующую команду, чтобы запустить все сервисы:

    ```bash
    docker-compose up --build -d
    ```

## Тестовый клиент

В проекте есть простой клиент (`client/main.go`), который демонстрирует работу с gRPC-сервисами. Он последовательно:
1. Создает двух пользователей.
2. Отправляет несколько сообщений от одного пользователя другому.

Для запуска клиента выполните команду:
```bash
go run client/main.go
```

## Генерация gRPC кода

Если вы вносите изменения в `.proto` файлы, вам необходимо перегенерировать gRPC код. Для этого выполните команду из корня проекта:

```bash
protoc --go_out=. --go-grpc_out=. proto/*.proto
```